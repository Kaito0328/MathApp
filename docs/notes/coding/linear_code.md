# Linear code（coding/src/linear.rs）

## 背景知識
線形符号は体上の部分空間であり、生成行列 G の行空間が符号の集合を与える。任意の情報語 u に対し v=u·G が符号語となるため、行列積だけで符号化が実現できる。GUIでは任意の G を与えて即時に符号化・可視化できる。

## 入力例と出力例
例（概念）。入力: k×n 生成行列 G と長さ k の情報語 u。出力: 長さ n の符号語 v=u·G。

## アルゴリズム
本実装は符号化のみを提供する。入力は生成行列 G（k×n）と情報語 u（長さ k）であり、出力は v = u·G（長さ n）である。

手順の詳説は以下のとおりである。
- 各列 j に対し v[j]=∑_{i=0}^{k−1} u[i]·G[i,j] を体 F 上で計算する。行優先・列優先いずれでも良いが、キャッシュ効率の観点では列ごとに内積するのが単純である。
- G が疎な場合は 0 でない要素のみ走査すると高速である。

```text
# G: k x n, u: 1 x k
v = zeros(n)
for j in 0..n-1:
	acc = 0
	for i in 0..k-1:
		acc += u[i] * G[i,j]   # 体 F 上の演算
	v[j] = acc
return v
```

制約と注意.
- G のランクが k に満たない場合、得られる符号は想定より小さい次元になる。必要に応じて系統形化（to_systematic_g）で検査する。
- 体 F は実装で与えられる演算に従う（GF(p) や拡大体など）。

計算量の目安.
- 一般に O(k·n)。疎行列最適化やビットパックにより定数倍を削減できる。
