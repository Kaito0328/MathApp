# 組合せ数（binom, Stirling）

## 背景知識
二項係数や第二種スターリング数は組合せ論の基本量である。数値的にはオーバーフローや不安定性を避けるために積の順序や対称性の利用が重要である。

## 入力例と出力例
- 入力: (n,k)。
- 出力: binom(n,k) または S(n,k)。

## アルゴリズム
- 二項係数 binom(n,k)
  - 対称性: k ← min(k, n−k)。これにより積の長さを短縮する。
  - 乗除逐次法（整数/有理で安全）:
    1) ans ← 1。
    2) for i=1..k: ans ← ans × (n+1−i) / i を都度既約化（gcd(ans, i)で割る）して桁溢れを避ける。
    3) 整数出力が必要ならループ内で分母を都度約分してから掛ける。
    - 計算量: O(k log n)（gcd を含む）。
  - Pascal DP（多数の binom を同時に要する場合）:
    - C[0]=1, C[j]=C[j]+C[j−1] を j=k..1 の逆順で更新（1次元ローリング）。
    - 計算量: O(nk)、メモリ O(k)。
  - 大数/浮動小数の安定化:
    - 対数で log binom(n,k)=log Γ(n+1)−log Γ(k+1)−log Γ(n−k+1) を使う（special-functions を参照）。
    - 精度が必要な場合は有理数/多倍長整数（number-theory など）へ委譲する。

- 第2種 Stirling 数 S(n,k)
  - 漸化式前進 DP: S(n,0)=[n=0], S(0,0)=1, それ以外 0。S(n,k)=k·S(n−1,k)+S(n−1,k−1)。
    - 1次元ローリング配列で j を降順に更新し k·S(n−1,k) を加算する。
    - 計算量: O(nk)、メモリ O(k)。
  - 包除和（検算/理論用）: S(n,k)=(1/k!)∑_{j=0..k}(−1)^j C(k,j)(k−j)^n。
    - 実装上は k が大きいと不安定になりやすいため DP を推奨する。

境界条件と注意:
- binom(n,0)=binom(n,n)=1、k<0 や k>n では 0 とする実装が安全である。
- Stirling 数では k>n で 0、k=0 は n=0 のときのみ 1 である。
