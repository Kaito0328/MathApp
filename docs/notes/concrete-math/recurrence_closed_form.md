# 線形漸化式と閉形式（ClosedForm）

## 背景知識
定係数線形漸化式の解は特性方程式の根 λ に対し n^r λ^n の線形結合で表せる。複素根を含む場合は複素指数になる。

## 入力例と出力例
- 入力: 係数と初期値からなる漸化式の定義。
- 出力: ClosedForm（一般項の和による表現）と，n に対する評価。

## アルゴリズム
1) 特性多項式と根の列挙
- a_d y_{n+d}+…+a_0 y_n = 0 に対し P(λ)=a_d λ^d+…+a_0 の根 {λ_i} と重複度 m_i を（polynomial の find_roots で）得る。

2) 一般解の基底
- 重根に対し {n^r λ^n | r=0..m_i−1} を基底とする。複素根は共役ペアが実部・虚部の正弦余弦形に変換可能。

3) 係数の同定（初期条件適合）
- y_0..y_{d−1} を既知として、一般解 y_n=∑_{i,r} c_{i,r} n^r λ_i^n に n=0..d−1 を代入して線形方程式を構成し、linalg の解法（RREF/solve）で c を解く。
- 数値安定化: 近接根では条件が悪化するためスケーリング/QR を用いる。

4) 部分和 partial_sum(cf)
- 幾何級数の和 ∑ λ^n=(1−λ^{N})/(1−λ)、n^r λ^n は λ d/dλ の作用で再帰的に導出する。r>0 は微分演算で構成し、多項式係数を掛ける。

計算量:
- 根の計算が支配（次数 d に対し数値的には O(d^3) 目安）。係数同定は O(d^3)。
