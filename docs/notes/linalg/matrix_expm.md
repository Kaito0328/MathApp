# 行列指数（expm: Padé 近似 + Scaling & Squaring）

## 背景知識
行列指数 e^A は微分方程式や LTI 離散化で登場する。高精度かつ安定な定番法はスケーリング＆スクエアリングと有理近似（Padé）である。

## 入力例と出力例
- 入力: A∈R^{n×n}，ノルム推定に基づくスケーリング s，Padé 次数 m（通常 m∈{3,5,7,9,13}）。
- 出力: expm(A)。

## アルゴリズム
- スケーリング
  1) ||A||_1 を推定し，閾値 θ_m に対して 2^{-s}||A||_1 ≤ θ_m となる最小の s を選ぶ。
  2) A_s = A / 2^s。
- Padé 近似 R_{m,m}(A_s) = N(A_s)/D(A_s)
  - 係数 a_k を固定し，U=Σ_{k odd} a_k A_s^k，V=Σ_{k even} a_k A_s^k を Horner で組む。
  - R=(V−U)^{-1}(V+U) を solve で評価（逆行列を明示的に作らない）。
- スクエアリング
  - s 回，R ← R^2。

### 境界条件・安定化
- A が非正則でも問題ないが，(V−U) が特異に近い場合はダンピングや次数変更を検討。
- 多項式評価は Horner でメモリアクセスを最小化。対称/疎行列のときは専用最適化が有効。

### 計算量
- 主に行列積・線形方程式解で O(n^3)。
