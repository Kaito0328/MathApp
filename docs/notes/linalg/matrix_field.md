# 行列（体演算・基本）

## 背景知識
要素が体のとき RREF，ランク，行列式，逆行列，LU 分解などが定義できる。本クレートは基本 LU と汎用 LU の 2 系統を提供する。

## 入力例と出力例
- 入力: 正方/長方の行列、ベクトル。
- 出力: RREF，ランク，解ベクトル/行列など。

## アルゴリズム
- RREF/ランク:
	- 列ごとにピボット候補を探索し、最大絶対値の行へスワップ（部分ピボット）。
	- ピボットを 1 に正規化し、他行の同列を掃き出して零にする。ピボット列数がランクとなる。
	- エッジ: 全零列はスキップ、数値では閾値（tol）未満を 0 とみなす。
- 行列式/逆行列:
	- LU 分解 A=PA=LU（P は置換行列）で det(A)=sgn(P)·∏ diag(U)。
	- 逆行列は同次元の単位行列を右辺にして LU/solve を列ごとに適用（またはガウス・ジョルダン）。
- LU 分解と解法:
	- LU（部分ピボット）: 前進/後退代入で Ax=b を解く。
	- 前進代入: Ly=Pb、後退代入: Ux=y。複数右辺は行列としてまとめて解く。
- 連立一次方程式:
	- `solve_generic` は特異の検出、ランク落ちの扱い（最小二乗/擬似逆にフォールバック）などを内包する設計である。

安定化・注意:
- 部分ピボットで数値安定性を改善。極端に悪条件では列ピボットやスケーリングを検討する。
- RREF のゼロ判定は機械イプシロンに基づく tol を設ける。

### 計算量と制約
- ガウス消去/LU は O(n^3)。特異行列では逆は存在しない。部分ピボットで安定化する。
