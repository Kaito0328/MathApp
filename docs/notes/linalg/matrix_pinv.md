# 擬似逆（Moore–Penrose）

## 背景知識
擬似逆 A^+ は最小二乗解 x=A^+ b を与える。SVD に基づく実装が最も安定であり，しきい値で小特異値を打ち切ることでノイズに頑健になる。

## 入力例と出力例
- 入力: A∈R^{m×n}（m≠n 可），トレランス τ（相対/絶対）。
- 出力: A^+∈R^{n×m}。

## アルゴリズム
- SVD による擬似逆
  1) A=U Σ V^T を計算。
  2) Σ^+ を作る: σ_i>τ のとき 1/σ_i，それ以外は 0。
  3) A^+=V Σ^+ U^T を返す。
- トレランスの選び方
  - 相対: τ = max(m,n)·ε·max_i σ_i。絶対: 事前スケールの大きさに基づき定数を指定。

### 境界条件・安定化
- スケーリングを行い，計算後に元スケールに戻すと条件数改善に有効。
- 列ピボット QR による rank 推定と併用すると高速に近似擬似逆を計算できる場合がある。

### 計算量
- SVD O(min(m,n)·mn)。
