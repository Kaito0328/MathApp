# 特異値分解（SVD: Golub–Kahan → バイディアゴナル QR）

## 背景知識
SVD は A=UΣV^T（実）で表し，条件数評価，擬似逆，低ランク近似に不可欠である。数値的にはまずバイディアゴナル化し，続いてバイディアゴナル行列に対する QR 反復で特異値を得る。

## 入力例と出力例
- 入力: A∈R^{m×n}。
- 出力: U∈R^{m×m}，Σ（対角）∈R^{m×n}，V∈R^{n×n}（必要な部分のみ計算も可）。

## アルゴリズム
- Golub–Kahan バイディアゴナル化
  1) k=1..min(m,n) で左 Householder で列の下を消去（u_k），右 Householder で行の右を消去（v_k）。
  2) B=u_k^T ... A ... v_k として上・下バイディアゴナルを得る。U,V に反射を蓄積。
- バイディアゴナル QR 反復
  1) 末端から切り離し（小要素で分割）。
  2) Wilkinson シフトを用いた QR ステップで収束を加速。
  3) 収束した要素を対角へ押し込み，符号整合性を取る（Σ≥0）。
- 擬似逆/低ランク
  - しきい値 τ で σ_i<τ をゼロとみなし，Σ^+ を構成。rank-k 近似は上位 k の σ で切る。

### 境界条件・安定化
- 退化特異値のクラスタで回転（Givens）を安定に適用。
- U/V を明示的に組み立てるか遅延適用かを選べる API。

### 計算量
- バイディアゴナル化 O(m n^2)，QR 反復は収束依存（概ね O(n^3)）。
