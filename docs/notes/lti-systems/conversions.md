# 連続⇄離散変換（双一次/Tustin、プリワープ、逆Tustin、インパルス不変）

## 背景知識
アナログ-ディジタル間の変換は周波数特性を一定の規準で保存する。双一次変換は周波数軸の写像が非線形で、プリワープで所望周波数に一致させる。インパルス不変はインパルス応答を一致させる。

## 入力例と出力例
- 入力: 連続 TF、fs、プリワープ周波数 f_warp、または離散 TF と定数 K。
- 出力: 変換後の TF（fs を保持）。

## アルゴリズム
- 双一次: s = K (1 - z^{-1})/(1 + z^{-1})、既定 K=2fs。多項式基底 (1±z^{-1}) のべきで展開し係数を合成する。
- プリワープ: K を ω_a / tan(ω_d/2)（ω_a=2π f_warp, ω_d=2π f_warp / fs）で決める。
- 逆Tustin: z^{-1} = (1 - s/K)/(1 + s/K) を同様に多項式展開する。
- インパルス不変: 部分分数展開→各極 p_i を α_i=exp(p_i Ts) に写像→(1-α_i z^{-1})^{m_i} を分母に構成し、実係数化する。多項式部は定数のみ許容し B += c0·A とする。

実装詳細と注意:
- 双一次の係数生成: 分子/分母の次数 n を合わせ、(1±z^{-1}) の冪多項式を前計算して線形結合する。最後に共通スケールを適用して a0=1 へ正規化する。
- プリワープ: 設計通過域の代表周波数に合わせて K を調整する。複数周波数を厳密一致させることはできない。
- 逆Tustin: ディジタルから等価アナログの近似であり、高次・不安定零点に対しては非物理的になることがある。
- インパルス不変: PFE で重極を扱う際は高次の項に T^{r−1}/(r−1)! スケールが付く。共役極はペアで合成して実係数に落とす。非厳密真有理（分子次数≥分母）は直達項へ分離してから処理する。
