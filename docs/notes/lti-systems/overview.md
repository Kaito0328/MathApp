# lti-systems 概要

## 背景知識
本クレートは LTI（線形時不変）システムの表現と解析を提供する。連続時間の伝達関数 G(s) と離散時間の伝達関数 H(z)、状態空間表現（連続/離散）、ゼロ・極・ゲイン（ZPK）表現、連続⇄離散変換（双一次/Tustin、プリワープ、逆Tustin、インパルス不変）、各種応答（インパルス/ステップ/周波数）、ブロック線図の構成（合成・SVG出力）を実装している。多項式と有理関数は polynomial クレート、線形代数は linalg クレートに依存する。

## 入力例と出力例
- 伝達関数（連続/離散）: 係数ベクトルまたは Polynomial から生成→零点・極・安定性・応答の計算結果。
- 状態空間: 行列 A,B,C,D とサンプル周波数→ ZOH 離散化や応答シミュレーション結果。
- 変換: fs, プリワープ周波数など→ 変換後の TF（fs を保持）。
- 図: 合成式 BlockExpr → SVG ファイル。

## アルゴリズム
- 伝達関数: 多項式根の計算で零点・極を得て、評価や合成（直列/並列/フィードバック）を有理関数演算で行う。
- 離散 TF の適用は直接形Iの差分方程式で実装する。
- 状態空間: ZOH はブロック行列の行列指数で Ad, Bd を得る。SISO の可制御正準形により TF⇄SS の往復を簡易に扱う。
- 変換: 双一次（K=2fs）/プリワープ/逆Tustin、インパルス不変（部分分数展開→指数写像→実係数化）。
- 応答: 連続 TF は ZOH で離散化してから離散 SS でシミュレーションする。周波数応答は s=jω または z=e^{jω} を評価する。
