# 応答（インパルス/ステップ/周波数、Bode/Nyquist）

## 背景知識
LTI の基本応答はインパルス・ステップ・周波数応答である。Bode は振幅/位相を対数軸で表示し，Nyquist はベクトル軌跡を描く。

## 入力例と出力例
- 入力: 連続/離散 TF または離散 SS，fs，系列長 len，サンプル数 n_freqs や ω_max。
- 出力: 応答列または複素スペクトル列。

## アルゴリズム
- 離散 TF: 直接形Iで h[n], s[n] を計算する。周波数応答は z=e^{jω} を均等サンプリング。
- 連続 TF: ZOH で離散 SS に変換してからシミュレーションする。
- Bode: frequency_response の振幅|G(jω)|と位相∠G(jω)を対数周波数グリッドに描画する（例では線形グリッドから補間）。
- Nyquist: 周波数応答を複素平面にプロットする。

実装詳細と注意:
- DFI 応答はゼロ初期条件で実装し、a0 を 1 に正規化してから差分を評価する。長系列は数値ドリフトに注意。
- 周波数応答のサンプリング: 連続は ω ∈ [0, ω_max] を線形または対数で、離散は ω_k=2πk/n（k=0..n−1）。
- Bode: 10のべきごとの対数グリッドでサンプルし、位相のアンラップ処理を行う。
- Nyquist: 安定性判別（−1点まわり）では十分な帯域までサンプルし、共役対称性を活用して計算量を半減できる。
