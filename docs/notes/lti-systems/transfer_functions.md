# 伝達関数（連続 G(s) / 離散 H(z)）

## 背景知識
伝達関数は有理関数で表される。連続では s 平面で極の実部<0が安定、離散では z 平面で単位円内が安定である。実装では numerator/denominator を polynomial::Polynomial として保持する。

## 入力例と出力例
- 入力: 係数 b[], a[] または Polynomial。連続は G(s)=B(s)/A(s)、離散は H(z)=B(z)/A(z) とする。離散はサンプリング周波数 fs を内部に保持する。
- 出力: zeros/poles（find_roots）、安定性判定、インパルス/ステップ/周波数応答。

## アルゴリズム
- 連続: eval_s(s)=B(s)/A(s)、周波数応答は s=jω をサンプリング。双一次や ZOH で離散化してから時系列応答を得る。
- 離散: 直接形I で差分方程式を逐次計算する。
  - y[n] = (1/a0)(∑_{i=0..M} b[i] x[n-i] - ∑_{j=1..N} a[j] y[n-j])。
- 合成: series は畳み込み（有理関数の積）、parallel は和、feedback は G/(1±GH) を返す。

実装詳細と安定化:
- 直接形Iの境界: n<i や n<j の参照は 0 とみなす（ゼロ初期条件）。a0≠0 を検証し、必要なら正規化（係数全体を a0 で割る）。
- IIR の内部状態でオーバーフローやドリフトが出る場合、直接形II（トランスポーズ）や二次節列（biquad）への分解を検討する。
- 有理演算の合成後は多項式の先頭ゼロ除去と monic 化（必要ならスケーリング）で正規形を保つ。
