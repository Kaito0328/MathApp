# RationalFunction と部分分数

## 背景知識
有理関数は二つの多項式の比で表され、極（分母の根）と零点（分子の根）で性質が決まる。制御・信号処理・積分計算などで頻出する。

## 入力例と出力例
- 入力: 分子 p(x)、分母 q(x)。
- 出力: 既約化された r(x)=p/q と、その部分分数展開。

## アルゴリズム
- 既約化: gcd を取り、共通因子で (p,q) を割る。
- 評価/微分: 定義通り（p/q の商・積の微分則）。
- 極の抽出と部分分数展開:
  - 分母 q の根を求め（実装の Root/solver を使用）、重根は重複度として扱う。
  - 各極に対し係数を決定し ∑_{k=1..m_i} A_{i,k}/(x−a_i)^k の和に分解する。
    - 単純極: A_{i,1} = p(a_i)/q'(a_i)。
    - 重極: (x−a_i)^{m_i} r(x)=p(x)/q(x) とおき、A_{i,k} は適切な導関数評価や比較で解く（線形方程式化も可）。
  - 実装では複素根を扱い、実係数への戻しでは共役ペアの係数をまとめて実数多項式に再構成する。

### 計算量と制約
- 既約化は gcd のコストに依存。根探索のコストは用いるメソッドに依存する（数値法では収束と許容誤差に注意）。
 - PFE の係数決定は根が既知なら O(n^2) 程度。重極が多いと安定性が悪化するため、スケーリング・丸め・tol を設定する。
