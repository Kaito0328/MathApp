# FIR フィルタ

## 背景知識
FIR は有限インパルス応答を係数列（タップ）で表す。窓法により理想特性から有限長のタップを設計できる。

## 入力例と出力例
- 入力: 欲しい特性（低域/高域/帯域）とサンプルレート、タップ数や窓種類。
- 出力: フィルタ係数と適用結果 Signal。

## アルゴリズム
1) 窓法（Windowing）
	- 理想低域: h_d[n] = (ω_c/π)·sinc(ω_c(n−α)/π), α=(M−1)/2。
	- 窓 w[n] を掛け h[n]=h_d[n]·w[n]，線形位相を保つため偶対称/奇対称の選択に注意。
	- Kaiser 窓: w[n]=I0(β√(1−((n−α)/α)^2))/I0(β)。β は目標減衰 A[dB] と遷移幅 Δω から経験式で決める。

2) 周波数サンプリング法
	- 望ましい H[k] を N 点で与え，逆 FFT で h[n] を得る。ガウス窓等でリップルを抑える。

3) Parks–McClellan（Remez 交換法）の概要
	- Chebyshev 意味での最大偏差を最小化する最適 FIR を求める。帯域ごとに重み付けして誤差が等波形になるよう極値点を更新する。
	- 実装が重い場合は窓法で初期値→微調整のみ採用する。

4) 適用（Convolution）
	- 直接法: y[n]=Σ_{k=0}^{M-1} h[k]·x[n−k]。線形位相対称性を用いて乗算回数半減が可能。
	- 周波数法: Overlap-Add/Save を用いる（DFT ノート参照）。長大 T で有利。

### 境界条件・安定化
- 偶奇対称の選択を誤ると群遅延が 0.5 サンプルずれる。M を奇数にして対称中心を整数化するのが安全である。
- 短い M では理想特性に届かないため，遷移幅を広げて減衰 A を妥協するか，サンプルレート変換用に多相（polyphase）実装を採る。
- 周波数設計ではナイキスト点と DC の実数性を保つ。

### 計算量
- 設計: 窓法 O(M)。Parks–McClellan は 反復×O(M)×帯域数。
- 適用: 直接法 O(T·M)。FFT 法は 1 ブロック O(L log L)。
