# サンプリングとリサンプリング

## 背景知識
サンプリング周波数の変更（ダウンサンプル/アップサンプル/リサンプル）ではエイリアシング回避のための前後フィルタ処理が不可欠である。

## 入力例と出力例
- 入力: 信号と係数（因子・タップ数・窓）。
- 出力: 新しいサンプルレートの信号。

## アルゴリズム
- ダウンサンプル M 分の 1（decimate）
	1) カットオフ ω_c ≈ π/M のローパス FIR を設計（遷移幅を確保）。
	2) x をフィルタし，M ごとに 1 サンプルを残す。polyphase 実装なら M 相に分けて計算量を 1/M 倍に削減できる。

- アップサンプル L 倍（expand）
	1) サンプル間に L−1 個の 0 を挿入。
	2) 画像抑圧ローパス FIR を適用。polyphase（分数遅延）で L 相を順次出力する。

- 有理比 L/M のリサンプリング
	1) 共有設計: カットオフを min(π/L, π/M) に設定し 1 つのローパスを設計。
	2) 多相フィルタを構築し，ストリームを L 倍拡大→FIR→M 分の 1間引きで出力。
	3) オフセット位相を指定可能にして帯域端での誤差を最小化する。

### 境界条件・安定化
- フィルタ長 M に応じて遷移帯域が必要。短すぎるとエイリアシング/イメージが残留する。
- 境界パディング: 反転（symmetric）、ゼロ、循環のいずれかを明示的に選ぶ。
- 多段（例: ×2 を数回）に分けると設計容易かつ計算量を抑えられる。

### 計算量
- 直接実装は O(T·K)。polyphase で 1/ max(L,M) 倍程度に削減。FFT 法は長大信号で有利。

### 計算量と制約
- フィルタ適用コストが支配的。境界の取り扱いと群遅延に注意。
