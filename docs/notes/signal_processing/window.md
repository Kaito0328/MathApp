# 窓関数と設計式

## 背景知識
窓関数は有限長でのスペクトル漏れ・サイドローブを制御するために用いる。Kaiser 窓は設計自由度（β）によりトレードオフを調整できる。

## 入力例と出力例
- 入力: サイズ，窓種類，Kaiser の減衰量など。
- 出力: 窓係数列。

## アルゴリズム
- 代表的な窓
	- Hamming: w[n]=0.54−0.46 cos(2πn/(M−1))。サイドローブ ≈ −41 dB。
	- Blackman: 3 項 cos 窓でサイドローブ ≈ −74 dB。
	- Hann: 0.5−0.5 cos(2πn/(M−1))。主ローブ広，サイドローブ中。
	- Kaiser: w[n]=I0(β√(1−((n−α)/α)^2))/I0(β)。β でトレードオフ調整。

- Kaiser の設計指針
	- 目標減衰 A[dB] と遷移幅 Δω（0..π）から
		β ≈ { 0.1102(A−8.7) if A>50, 0.5842(A−21)^0.4+0.07886(A−21) if 21≤A≤50, 0 otherwise }
	- フィルタ長 M ≈ (A−8)/(2.285·Δω) + 1。

- Bessel I0 近似
	- 級数 I0(x)=Σ_{k=0}^∞ (x/2)^{2k}/(k!)^2 を部分和で評価し，大きい x は漸近展開で切替える。

### 境界条件・安定化
- 端点の定義（含む/含まない）を一貫させる。線形位相 FIR では中心 α=(M−1)/2 を明示する。
- 固定小数点では β が大きいとアンダーフローするため正規化を段階的に行う。

### 計算量
- 生成 O(M)。I0 は項数に比例。

### 計算量と制約
- 生成は O(N)。β 推定式は経験式であり設計仕様に合わせて調整が必要。
