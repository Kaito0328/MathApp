# ベータ関数と正則化ベータ

## 背景知識
ベータ関数は二つのガンマ関数により B(a,b)=Γ(a)Γ(b)/Γ(a+b) と定義され，分布の正規化定数などに現れる。

## 入力例と出力例
- 入力: a,b,x。
- 出力: beta(a,b), log_beta(a,b), regularized_beta(a,b,x)。

## アルゴリズム
- beta/log_beta
	- log_beta = log Γ(a)+log Γ(b)−log Γ(a+b) を用い，beta は exp で返す（桁あふれ回避）。

- 正則化ベータ I_x(a,b)
	- 対称性: x> (a+1)/(a+b+2) では I_x(a,b)=1−I_{1−x}(b,a) を用いると収束が良い。
	- 連分数: I_x(a,b)=x^a(1−x)^b/(a·B(a,b))·1/(1+ d_1/(1+ d_2/(1+…))) を Lentz 法で評価。
		- Lentz 法: C_0=F_0=0，C_k=1/(1+d_k C_{k−1}), F_k=F_{k−1}·(C_k−1) などの更新でゼロ割れ・桁落ちを防ぐ。
	- 端点 x≈0,1 では対数で扱い，必要なら級数（x 小）や（1−x 小）に切替える。

### 計算量と制約
- 反復回数 K に依存。a/b のアンバランスが大きいと K が増える。
- log 空間での計算を基本とし，underflow/overflow を避ける。端点での丸めに注意。
