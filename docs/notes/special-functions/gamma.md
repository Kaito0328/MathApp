# ガンマ関数と関連関数

## 背景知識
ガンマ関数は階乗の連続拡張であり Γ(n)=(n−1)!（n∈ℕ）を満たす。統計分布やベータ関数の定義に現れる。

## 入力例と出力例
- 入力: z, s, x など（実数）。
- 出力: gamma(z), log_gamma(z), regularized_gamma(s,x), factorial(n)。

## アルゴリズム
- log_gamma（Lanczos 近似）
	1) 定数 g と係数 c_k を固定。
	2) x>0 のとき，A(x)=c_0+Σ_{k=1}^m c_k/(x+k−1)，t=x+g+1/2。
	3) log Γ(x) ≈ (x−1/2)log t − t + log(√(2π)·A(x))。
	4) x<0.5 は反射公式 Γ(x)Γ(1−x)=π/sin(πx) を用い，log Γ(x)=log π−log sin(πx)−log Γ(1−x)。

- gamma(x)
	- log_gamma を計算して exp する。極端な x ではスケール付き exp を用いオーバーフローを回避する。

- 不完全ガンマ P(s,x), Q(s,x)
	- 小 x（x < s+1）: 級数展開 P(s,x)=e^{−x} x^s/Γ(s) Σ_{k=0}^∞ x^k/(s(s+1)…(s+k)) を収束まで加算。
	- 大 x（x ≥ s+1）: 連分数による Q(s,x)=e^{−x} x^s/(x+1−s− (1·(1−s))/(x+3−s− …)) を Lentz 法で安定評価。P=1−Q。

- factorial(n)
	- n が小さい場合はテーブルまたは逐次乗算。n が大きい場合は Stirling 近似または多倍長へ。

### 計算量と制約
- Lanczos は O(m)。不完全ガンマは反復数 K に依存（通常 10–100 程度）。
- sin(πx) が 0 に近いときの反射公式は不安定。必要なら倍精度以上や Payne–Hanek の角度削減を用いる。
- log_gamma を基本として対数領域で計算し，乗除のオーバーフローを避ける。
