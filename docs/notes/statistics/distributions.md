# 確率分布（連続・離散・多変量）

## 背景知識
確率分布は PDF/PMF/CDF/SF/PPF などの基本操作を備える。対数確率（logpdf/logpmf）はアンダーフローを避けるために重要である。

## 入力例と出力例
- 連続分布: 正規 N(μ, σ^2)，t(ν)，F(d1, d2)，χ^2(k)，ガンマ(k, θ)，指数(λ)，一様(a,b)。
- 離散分布: ベルヌーイ(p)，二項(n,p)，ポアソン(λ)。
- 多変量: 多変量正規(μ, Σ)，多変量t(μ, Σ, ν)，ディリクレ(α)。

## アルゴリズム
- 正規 N(μ,σ^2)
	- pdf: φ((x−μ)/σ)/σ，cdf: 0.5·(1+erf((x−μ)/(σ√2)))，ppf: erf_inv を利用。
	- 安定化: 尾部は erfc を使う。

- t(ν)
	- pdf: Γ((ν+1)/2)/(√(νπ) Γ(ν/2)) (1+x^2/ν)^{−(ν+1)/2}。
	- cdf/ppf: 不完全ベータを利用（special-functions/beta）。

- χ^2(k), F(d1,d2)
	- χ^2 cdf: 下側不完全ガンマ P(k/2, x/2)。F cdf: ベータの正則化に帰着。

- ガンマ(k,θ)
	- pdf: x^{k−1} e^{−x/θ}/(Γ(k) θ^k)。cdf: P(k, x/θ)。
	- 乱数: 形状に応じて Marsaglia–Tsang（k≥1）/Kundu–Gupta（k<1）。

- ベータ(a,b)
	- pdf: x^{a−1}(1−x)^{b−1}/B(a,b)。cdf: I_x(a,b)。

- 一様(a,b)
	- pdf/cdf は閉形式。ppf: a+(b−a)u。

- ベルヌーイ(p), 二項(n,p)
	- pmf: C(n,k) p^k (1−p)^{n−k}。logpmf は log Γ で安定化。
	- 近似: n 大で正規/ポアソン近似。

- ポアソン(λ)
	- pmf: e^{−λ} λ^k/k!。cdf: 不完全ガンマと関係。

- 多変量正規 N(μ, Σ)
	- 対数確率: −0.5[(x−μ)^T Σ^{−1} (x−μ) + log det Σ + d log(2π)]。
	- 実装: Cholesky で Σ=LL^T，三角解で Σ^{−1}y を計算し，log det Σ = 2 Σ log diag(L)。
	- 乱数: z~N(0,I)，x=μ+Lz。

### 計算量と制約
- 多変量は行列分解 O(d^3)。その他は O(1) 評価だが，special-functions の反復回数に依存する場合がある。
- パラメータ領域の検証（σ>0, ν>0, k>0, θ>0, 0≤p≤1, Σ≻0）を必須とする。
