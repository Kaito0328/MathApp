# 仮説検定

## 背景知識
検定は帰無仮説 H0 と対立仮説 H1 を定め，検定統計量を計算し，対応分布の下での p 値を求める手続きである。等分散/不等分散，両側/片側などの前提を明確にする必要がある。

## 入力例と出力例
- 1標本 t 検定: 標本 {xi}, 母平均 μ0。
- 2標本 t 検定: 2群 {xi}, {yj}，等分散/不等分散（Welch）指定。
- χ^2 適合度/独立性，F 検定，z 検定，ANOVA，ノンパラ（Mann–Whitney, Wilcoxon, Kruskal–Wallis）。

## アルゴリズム
- 1 標本 t 検定（平均 μ0）
	1) x の平均 m，標本標準偏差 s，n を算出。
	2) t = (m−μ0)/(s/√n)。両側/片側を選び t 分布 CDF から p 値。

- 2 標本 t（等分散）
	1) 各群の m1,m2,s1^2,s2^2,n1,n2。プールド分散 sp^2=((n1−1)s1^2+(n2−1)s2^2)/(n1+n2−2)。
	2) t=(m1−m2)/[sp·√(1/n1+1/n2)], 自由度 ν=n1+n2−2。

- Welch t（不等分散）
	- t=(m1−m2)/√(s1^2/n1 + s2^2/n2)。自由度は Welch–Satterthwaite。

- 比率の z 検定
	- p̂=k/n，z=(p̂−p0)/√(p0(1−p0)/n)。両側/片側の標準正規 CDF。

- χ^2 適合度/独立性
	- 適合度: Σ (O_i−E_i)^2/E_i。独立性: 分割表で (row sum)(col sum)/total を期待度数に。

- F 検定 / 一元配置 ANOVA
	- 群間 MS_B，群内 MS_W から F=MS_B/MS_W，F 分布で p 値。

- ノンパラ（例）
	- Mann–Whitney U: 結合ランク和から U を計算，n が大なら正規近似。
	- Wilcoxon 符号付き順位: 差の符号と順位で W，正確検定または正規近似。

### 境界条件・安定化
- 前提（正規性・等分散・独立性）を明示し，外れ値が強い場合はロバスト検定を考慮。
- 期待度数が小さい χ^2 は Fisher の正確検定を検討。
- 多重比較は Bonferroni/BH による補正を適用。

### 計算量と制約
- いずれも O(n log n)（ソート）または O(n)。正確検定は組合せ計算で指数的になりうる。
