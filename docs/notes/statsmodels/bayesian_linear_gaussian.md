# ベイズ線形ガウス推定（共役事前）

## 背景知識
観測 y = Hx + ε, ε~N(0,R) とし，事前 x~N(m0, C0^{-1})（または精度 Q0=C0^{-1}）を仮定する。ガウス-ガウスは共役で，事後もガウスになる。

## 入力例と出力例
- 入力: y, H, 事前平均 m0, 事前共分散 C0 または精度 Q0, ノイズ共分散 R
- 出力: 事後平均 m, 事後共分散 C

## アルゴリズム
- 事前と尤度
	- 事前: x~N(m0, C0)（精度 Q0=C0^{−1}）。尤度: y|x ~ N(Hx, R)。

- 事後（共役）
	- 精度: Q = Q0 + H^T R^{−1} H。
	- 平均: m = Q^{−1}(Q0 m0 + H^T R^{−1} y)。
	- 予測分布: y|data ~ N(H m, H Q^{−1} H^T + R)。

- ハイパーパラメタ学習（EM 概略）
	1) E: 現在のパラメタで x の事後 N(m,C) を算出。
	2) M: Q0, m0, R を対数周辺尤度を最大化するよう更新（トレースと二次形式）。

- 安定化
	- 連立は solve/cholesky で解き，対称性・正定値性を保つ。必要ならジャイタ εI を加える。

### 計算量と制約
- 行列分解 O(d^3)。Q, R は半正定値で，数値誤差で非対称になった場合は (A+A^T)/2 による対称化を行う。
