# カルマンフィルタ

## 背景知識
線形ガウス状態空間モデル x_k = F x_{k-1} + w_k, z_k = H x_k + v_k を対象に，x と共分散 P を逐次推定する。

## 入力例と出力例
- 入力: 初期状態 x_0, P_0，行列 F, H，共分散 Q, R
- 出力: 各時刻の推定 x̂_k, P_k

## アルゴリズム
- 予測: x̂_{k|k−1}=F x̂_{k−1|k−1}, P_{k|k−1}=F P_{k−1|k−1} F^T+Q。
- 更新: S=H P H^T+R，K=P H^T S^{−1}（solve 使用）。e=z−H x̂_{k|k−1}。
- 共分散更新（Joseph 形式）: P_{k|k}=(I−KH)P_{k|k−1}(I−KH)^T+K R K^T（数値安定）。
- スムーザ（RTS）の概要: 逆走査で G_k=P_{k|k} F^T P_{k+1|k}^{−1}，x̂_{k|N}=x̂_{k|k}+G_k(x̂_{k+1|N}−x̂_{k+1|k})。

### 計算量と制約
- 行列演算 O(n^3)。Q,R は半正定値で，数値的にわずかに非対称になった場合は対称化する。
