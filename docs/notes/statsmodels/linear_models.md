# 線形モデル（OLS / Ridge / Lasso）

## 背景知識
設計行列 A と目的変数 b に対し，最小二乗の解を求める。A がフルランクでない場合や列数が多い場合に数値安定な手段が必要である。

## 入力例と出力例
- 入力: A∈R^{n×d}, b∈R^n, 正則化パラメータ α（Ridge/Lasso）
- 出力: 係数ベクトル x∈R^d

## アルゴリズム
- OLS
	- QR 分解: A=QR，最小二乗解は R 上三角で back-substitution。病的行列には列ピボット QR を使う。
	- SVD: A=UΣV^T，x=VΣ^+U^T b。特異値が小さい場合はしきい値で打ち切り（擬似逆の安定化）。

- Ridge（L2 正則化）
	- SVD で x = V diag(σ/(σ^2+α)) U^T b（注: 実装の α の定義に合わせる）。
	- 交差検証で α を選ぶのが実務的である。

- Lasso（L1 正則化，座標降下）
	1) 標準化: 各列を平均 0，分散 1 にスケーリング（切片を別扱い）。
	2) 反復: j=1..d で ρ_j=a_j^T (b − A_{−j}x_{−j}) を計算。
	3) ソフトしきい値: x_j←S(ρ_j, λ)/||a_j||^2，S(u,λ)=sign(u)·max(|u|−λ,0)。
	4) 収束: ||x^{(t)}−x^{(t−1)}||_∞ < tol で停止。強凸でない場合はサイクル回避の注意。

### 計算量と制約
- OLS/Ridge: SVD O(min(n,d)·nd)。QR は O(nd^2)。
- Lasso: 1 エポック O(nnz(A)) 目安。疎行列では効率が高い。
- スケーリングと切片扱い，正則化パス（warm start）の設計が精度と速度に影響。
